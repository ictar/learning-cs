目录
=================

   * [打包和工具链](#打包和工具链)
      * [包](#包)
         * [包名惯例](#包名惯例)
         * [main 包](#main-包)
      * [导入](#导入)
         * [远程导入](#远程导入)
         * [命名导入](#命名导入)
            * [使用空白标识符重命名导入](#使用空白标识符重命名导入)
      * [函数 init](#函数-init)
      * [使用 Go 的工具](#使用-go-的工具)
      * [与其他 Go 开发者合作](#与其他-go-开发者合作)
      * [依赖管理](#依赖管理)


# 打包和工具链

## 包
所有 Go 语言的程序都会组织成若干组文件，每组文件被称为一个**包**。
* 所有的.go文件，除了空行和注释，都应该在第一行声明自己所属的包。
* 每个包都在一个单独的目录里，同一个目录下的所有.go文件必须声明同一个包名。
  * 不能把多个包放到同一个目录中，
  * 也不能把同一个包的文件分拆到多个不同目录中。

### 包名惯例
惯例：
* 使用包所在目录的名字。
  * 这让用户在导入包的时候，就能清晰地知道包名。
* 应该使用**简洁、清晰且全小写**的名字
  * 这有利于开发时频繁输入包名
* 并不需要所有包的名字都与别的包不同
  * 因为导入包时是使用全路径的，所以可以区分同名的不同包。

### main 包
Go语言的编译程序会试图把名字为 main 的包编译为二进制可执行文件。所有用Go语言编译的可执行程序都必须有一个名叫main的包。程序编译时，会默认使用声明main包的代码所在的目录的目录名作为二进制可执行文件的文件名。

main 包里一定要有 `main()` 函数，这是程序的入口。如果没有则不会创建可执行文件。

## 导入
`import` 语句告诉编译器想引用哪个位置的包里的代码。如果要导入多个包，习惯上是将 import 语句包装在一个导入块中：
```golang
import (
    "fmt"
    "os"
)
```

编译器会使用Go环境变量设置的路径，通过引入的相对路径来查找磁盘上的包：
* 标准库中的包会在安装Go的位置找到。
* Go开发者创建的包会在GOPATH环境变量指定的目录里查找。
  * GOPATH指定的这些目录就是开发者的个人工作空间。

一旦编译器找到一个满足import语句的包，就停止进一步查找。
> 注意：编译器会首先查找Go的安装目录，然后才会按顺序查找 GOPATH 变量里列出的目录

如果编译器查遍GOPATH也没有找到要导入的包，那么在试图对程序执行run或者build的时候就会出错。

> 环境变量GOPATH决定了Go源代码在磁盘上被保存、编译和安装的位置。可以为每个工程设置不同的GOPATH，以保持源代码和依赖的隔离。

### 远程导入
`go get` 将获取任意指定的URL的包，或者一个已经导入的包所依赖的其他包，并把包的源代码保存在GOPATH指向的路径里与URL匹配的目录里。这个命令会扫描某个包的源码树，获取能找到的所有依赖包。

### 命名导入
重名的包可以通过**命名导入**来导入。命名导入是指，在import语句给出的包路径的左侧定义一个名字，将导入的包命名为新名字。
```golang
import (
    newname "pkgpath"
)
```

当你导入了一个不在代码里使用的包时，Go编译器会编译失败，并输出一个错误。这可以避免代码变得臃肿。

#### 使用空白标识符重命名导入
有时，用户可能需要导入一个包，但是不需要引用这个包的标识符。在这种情况，可以使用空白标识符 `_` 来重命名这个导入。
```golang
import _ "pkgpath"
```

使用场景：使用空白标识符重命名这个导入可以让init函数发现并被调度运行，让编译器不会因为包未被使用而产生错误。

## 函数 init
`init` 函数用在设置包、初始化变量或者其他要在程序运行前优先完成的引导工作。

每个包可以包含任意多个 `init` 函数，这些函数都会在程序执行开始的时候被调用。所有被编译器发现的 `init` 函数都会安排在 `main` 函数之前执行。

## 使用 Go 的工具
```sh
# go 1.11
go <command> [arguments]

The commands are:

	bug         start a bug report
	build       编译包和依赖
	clean       清理编译生成的可执行文件、对象文件和缓存文件
	doc         显示包或者符号的文档
	env         打印 Go 环境信息
	fix         update packages to use new APIs
	fmt         自动格式化指定的源代码文件并保存
	generate    generate Go files by processing source
	get         download and install packages and dependencies
	install     compile and install packages and dependencies
	list        列出包或者模块
	mod         module maintenance
	run         编译并运行 Go 程序
	test        测试包
	tool        运行指定的 go 工具
	version     打印 Go 版本
	vet         报告包里可能的错误
```

## 与其他 Go 开发者合作
以分享为目的创建代码库：
* 包应该在代码库的根目录中
  * 避免导入语句过长
* 包可以非常小
  * 在 Go 语言中，小包很常见
* 对代码执行 `go fmt`
  * 让自己的代码可读性更好
* 给代码写文档
  * 按照 `go doc` 的最佳实践来写文档

## 依赖管理
> 注：原书这部分已经过期，目前 GO 提供了 [go module](https://blog.golang.org/using-go-modules) 依赖管理方式